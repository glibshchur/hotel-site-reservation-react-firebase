{"ast":null,"code":"import _toConsumableArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import Paper from'@material-ui/core/Paper';import Grid from'@material-ui/core/Grid';import SingleLineError from'../Error';import{withFirebase}from'../Firebase';import{compose}from'recompose';import React,{useEffect,useState,useRef}from'react';import{BrowserRouter as Router,Link,Route}from'react-router-dom';import{makeStyles}from'@material-ui/core/styles';import NullImage from'../Product/No-Image-Available.jpg';import Typography from'@material-ui/core/Typography';import TextField from'@material-ui/core/TextField';import ListItem from'@material-ui/core/ListItem';import List from'@material-ui/core/List';import Drawer from'@material-ui/core/Drawer';import{CardMedia,Card,CardContent,CardActions}from'@material-ui/core';import Button from'@material-ui/core/Button';import{withAuthentication,AuthUserContext}from'../Session';var useStyles=makeStyles({grid:{margin:0,padding:0,marginLeft:0},paper:{marginLeft:40,width:'100%',backgroundColor:\"rgba(0,0,0,0)\"},fullList:{width:'auto'},cartButton:{marginTop:20,height:47,width:'100%',color:'#FFFFFF',float:'center',backgroundColor:'#00B4F4',borderRadius:0,'&:hover':{backgroundColor:'#D6D6D6'}}});var CheckOutView=compose(withAuthentication,withFirebase)(function(props){return React.createElement(AuthUserContext.Consumer,null,function(authUser){return React.createElement(CheckOutViewBase,{authUser:authUser,firebase:props.firebase,history:props.history});});});var CheckOutViewBase=function CheckOutViewBase(props){var classes=useStyles();var storageRef=props.firebase.storage;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),total=_React$useState2[0],setTotal=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),products=_React$useState4[0],setProducts=_React$useState4[1];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),resInDate=_useState4[0],setInDate=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),resOutDate=_useState6[0],setOutDate=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),userFirstName=_useState8[0],setUserFirstName=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),userLastName=_useState10[0],setUserLastName=_useState10[1];// const [addressOne,    setAddressOne       ] = useState('');\n// const [addressTwo,    setAddressTwo       ] = useState('');\n// const [city,          setCity             ] = useState('');\n// const [country,       setCountry          ] = useState('');\n// const [code,          setCode             ] = useState('');\nvar _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),phone=_useState12[0],setPhone=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),roomName=_useState14[0],setRoomName=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),errors=_useState16[0],setErorrs=_useState16[1];useEffect(function(){setEmail(!!props.authUser&&!!props.authUser.email?props.authUser.email:'');setUserFirstName(!!props.authUser&&!!props.authUser.userFirstName?props.authUser.userFirstName:'');setUserLastName(!!props.authUser&&!!props.authUser.userLastName?props.authUser.userLastName:'');// setAddressOne   (!!props.authUser && !!props.authUser.addressOne    ? props.authUser.addressOne     : '') \n// setAddressTwo   (!!props.authUser && !!props.authUser.addressTwo    ? props.authUser.addressTwo     : '') \n// setCity         (!!props.authUser && !!props.authUser.city          ? props.authUser.city           : '') \n// setCountry      (!!props.authUser && !!props.authUser.country       ? props.authUser.country        : '') \n// setCode         (!!props.authUser && !!props.authUser.code          ? props.authUser.code           : '') \nsetInDate(!!props.authUser&&!!props.authUser.resDate?props.authUser.resDate:'');setOutDate(!!props.authUser&&!!props.authUser.resDate?props.authUser.resDate:'');setPhone(!!props.authUser&&!!props.authUser.phone?props.authUser.phone:'');},[]);useEffect(function(){if(!!localStorage.getItem('cart')){var obj=JSON.parse(localStorage.getItem('cart'));setTotal(0);setProducts([]);if(!!obj){obj.forEach(function(e){if(!!e.key)props.firebase.products().child(e.key).once('value',function(snapshot){if(snapshot.exists()){// Try to get url from the storage\nstorageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then(function(url){var element=_objectSpread({},snapshot.val(),{imageRef:url,key:snapshot.key});console.log(element.imageRef);if(element.isPublic){setTotal(function(t){return+t+ +element.price;});setProducts(function(a){return[].concat(_toConsumableArray(a),[element]);});}// if it fails set the url to the default image\n}).catch(function(err){var element=_objectSpread({},snapshot.val(),{imageRef:NullImage,key:snapshot.key});console.log(element.imageRef);if(element.isPublic){setTotal(function(t){return t+element.price;});setProducts(function(a){return[].concat(_toConsumableArray(a),[element]);});}});}});});}}},[]);var onSubmit=function onSubmit(event){var user={email:email,userFirstName:userFirstName,userLastName:userLastName,// addressOne,\n// addressTwo,\n// city,\n// country,\n// code,\nresInDate:resInDate,resOutDate:resOutDate,phone:phone,roomName:roomName};props.firebase.createOrder(JSON.parse(localStorage.getItem('cart')),user).catch(function(err){console.log(err);});localStorage.setItem('cart',JSON.stringify([]));props.history.push('/');event.preventDefault();};return React.createElement(React.Fragment,null,React.createElement(Drawer,{anchor:\"right\",open:props.open,onClose:function onClose(){return console.log(\"cart closed\");}},React.createElement(Link,{to:\"/checkout\"},\"\\u0411\\u0440\\u043E\\u043D\\u044E\\u0432\\u0430\\u043D\\u043D\\u044F\")),React.createElement(Grid,{container:true,className:classes.returningCustomerText},React.createElement(Grid,{item:true,xs:3},React.createElement(\"div\",{className:classes.returningCustomerText},React.createElement(Typography,{variant:\"h5\"},\" \\u0411\\u0440\\u043E\\u043D\\u044E\\u0432\\u0430\\u043D\\u043D\\u044F \"))),React.createElement(Grid,{item:true,xs:4},React.createElement(\"form\",{onSubmit:onSubmit},!!errors&&errors.map(function(err,id){return React.createElement(SingleLineError,{key:id,error:err});}),React.createElement(Grid,{container:true,spacing:2},React.createElement(TextField,{autoFocus:true,margin:\"normal\",name:\"addressOne\",value:email,onChange:function onChange(e){return setEmail(e.target.value);},id:\"addressOne\",label:\"\\u0415\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u043D\\u0430 \\u043F\\u043E\\u0448\\u0442\\u0430\",type:\"email\",required:true,fullWidth:true}),React.createElement(Grid,{item:true,xs:6},React.createElement(TextField,{name:\"firstName\",value:userFirstName,onChange:function onChange(e){return setUserFirstName(e.target.value);},type:\"text\",autoFocus:true,id:\"firstName\",label:\"\\u0406\\u043C'\\u044F\",required:true,fullWidth:true})),React.createElement(Grid,{item:true,xs:6},React.createElement(TextField,{name:\"lastname\",value:userLastName,onChange:function onChange(e){return setUserLastName(e.target.value);},type:\"text\",autoFocus:true,id:\"lastname\",label:\"\\u041F\\u0440\\u0456\\u0437\\u0432\\u0438\\u0449\\u0435\",required:true,fullWidth:true}))),React.createElement(TextField,{name:\"roomName\",value:roomName,onChange:function onChange(e){return setRoomName(e.target.value);},type:\"text\",autoFocus:true,id:\"roomName\",label:\"\\u041D\\u0430\\u0437\\u0432\\u0430 \\u043A\\u0456\\u043C\\u043D\\u0430\\u0442\\u0438\",required:true,fullWidth:true}),React.createElement(TextField,{name:\"phone\",value:phone,onChange:function onChange(e){return setPhone(e.target.value);},autoFocus:true,margin:\"normal\",id:\"phone\",label:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0443\",type:\"text\",required:true,fullWidth:true}),React.createElement(TextField,{name:\"indate\",value:resInDate,onChange:function onChange(e){return setInDate(e.target.value);},autoFocus:true,margin:\"normal\",id:\"indate\",label:\"\\u0414\\u0430\\u0442\\u0430 \\u0417\\u0430\\u0441\\u0435\\u043B\\u0435\\u043D\\u043D\\u044F\",type:\"text\",required:true}),React.createElement(TextField,{name:\"outdate\",value:resOutDate,onChange:function onChange(e){return setOutDate(e.target.value);},autoFocus:true,margin:\"normal\",id:\"outdate\",label:\"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u0438\\u0441\\u0435\\u043B\\u0435\\u043D\\u043D\\u044F\",type:\"text\",required:true}),React.createElement(Button,{className:classes.cartButton,type:\"submit\",color:\"primary\"},\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u0438\"))),React.createElement(Grid,{item:true,xs:4},React.createElement(Paper,{className:classes.paper,elevation:0},React.createElement(List,null,products.map(function(product,i){return React.createElement(ListItem,{className:classes.grid},React.createElement(Grid,{container:true,spacing:0},React.createElement(Grid,{item:true,xs:3},React.createElement(\"img\",{src:product.imageRef,width:'100%',height:'100%'})),React.createElement(Grid,{item:true,xs:9},React.createElement(Typography,null,\" \",product.name,\" \"),React.createElement(Typography,null,\" \",product.model,\" \"),React.createElement(Typography,null,\" \",product.price,\" \\u0433\\u0440\\u043D \"))));})),React.createElement(ListItem,null,React.createElement(Typography,{variant:\"h6\"},\" \\u0426\\u0456\\u043D\\u0430 : \",total,\" \\u0433\\u0440\\u043D/\\u043D\\u0456\\u0447 \"))))));};export default CheckOutView;","map":{"version":3,"sources":["/Users/hshchu/Desktop/github/e-commerce/src/components/CheckOut/index.js"],"names":["Paper","Grid","SingleLineError","withFirebase","compose","React","useEffect","useState","useRef","BrowserRouter","Router","Link","Route","makeStyles","NullImage","Typography","TextField","ListItem","List","Drawer","CardMedia","Card","CardContent","CardActions","Button","withAuthentication","AuthUserContext","useStyles","grid","margin","padding","marginLeft","paper","width","backgroundColor","fullList","cartButton","marginTop","height","color","float","borderRadius","CheckOutView","props","authUser","firebase","history","CheckOutViewBase","classes","storageRef","storage","total","setTotal","products","setProducts","email","setEmail","resInDate","setInDate","resOutDate","setOutDate","userFirstName","setUserFirstName","userLastName","setUserLastName","phone","setPhone","roomName","setRoomName","errors","setErorrs","resDate","localStorage","getItem","obj","JSON","parse","forEach","e","key","child","once","snapshot","exists","ref","val","previewImage","getDownloadURL","then","url","element","imageRef","console","log","isPublic","t","price","a","catch","err","onSubmit","event","user","createOrder","setItem","stringify","push","preventDefault","open","returningCustomerText","map","id","target","value","product","i","name","model"],"mappings":"opCAAA,MAAOA,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,eAAP,KAA4B,UAA5B,CACA,OAAQC,YAAR,KAA2B,aAA3B,CACA,OAAQC,OAAR,KAAsB,WAAtB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,OAASC,aAAa,GAAIC,CAAAA,MAA1B,CAAkCC,IAAlC,CAAwCC,KAAxC,KAAqD,kBAArD,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,SAAP,KAAsB,mCAAtB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CACA,MAAOC,CAAAA,SAAP,KAAsB,6BAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,4BAArB,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,WAA1B,CAAuCC,WAAvC,KAA0D,mBAA1D,CAEA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,OAASC,kBAAT,CAA6BC,eAA7B,KAAoD,YAApD,CAEA,GAAMC,CAAAA,SAAS,CAAGd,UAAU,CAAC,CAC3Be,IAAI,CAAC,CACHC,MAAM,CAAC,CADJ,CAEHC,OAAO,CAAC,CAFL,CAGHC,UAAU,CAAC,CAHR,CADsB,CAM3BC,KAAK,CAAE,CACLD,UAAU,CAAC,EADN,CAELE,KAAK,CAAE,MAFF,CAGLC,eAAe,CAAE,eAHZ,CANoB,CAW3BC,QAAQ,CAAE,CACRF,KAAK,CAAE,MADC,CAXiB,CAc3BG,UAAU,CAAC,CACTC,SAAS,CAAC,EADD,CAETC,MAAM,CAAC,EAFE,CAGTL,KAAK,CAAC,MAHG,CAITM,KAAK,CAAE,SAJE,CAKTC,KAAK,CAAC,QALG,CAMTN,eAAe,CAAE,SANR,CAOTO,YAAY,CAAC,CAPJ,CAQT,UAAU,CACRP,eAAe,CAAE,SADT,CARD,CAdgB,CAAD,CAA5B,CA6BA,GAAMQ,CAAAA,YAAY,CAAGtC,OAAO,CAACqB,kBAAD,CAAqBtB,YAArB,CAAP,CAA0C,SAACwC,KAAD,CAAW,CAExE,MACC,qBAAC,eAAD,CAAiB,QAAjB,MACG,SAAAC,QAAQ,QAAI,qBAAC,gBAAD,EAAkB,QAAQ,CAAEA,QAA5B,CAAsC,QAAQ,CAAED,KAAK,CAACE,QAAtD,CAAgE,OAAO,CAAEF,KAAK,CAACG,OAA/E,EAAJ,EADX,CADD,CAKD,CAPoB,CAArB,CASA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACJ,KAAD,CAAW,CAClC,GAAMK,CAAAA,OAAO,CAAGrB,SAAS,EAAzB,CACA,GAAMsB,CAAAA,UAAU,CAAGN,KAAK,CAACE,QAAN,CAAeK,OAAlC,CAFkC,oBAGR7C,KAAK,CAACE,QAAN,CAAe,CAAf,CAHQ,oDAG3B4C,KAH2B,qBAGpBC,QAHoB,0CAIF/C,KAAK,CAACE,QAAN,CAAe,EAAf,CAJE,qDAI3B8C,QAJ2B,qBAIjBC,WAJiB,mCAMY/C,QAAQ,CAAC,EAAD,CANpB,wCAM3BgD,KAN2B,eAMpBC,QANoB,8BAOiBjD,QAAQ,CAAC,EAAD,CAPzB,yCAO3BkD,SAP2B,eAOhBC,SAPgB,8BAQmBnD,QAAQ,CAAC,EAAD,CAR3B,yCAQ3BoD,UAR2B,eAQfC,UARe,8BASarD,QAAQ,CAAC,EAAD,CATrB,yCAS3BsD,aAT2B,eASZC,gBATY,8BAUavD,QAAQ,CAAC,EAAD,CAVrB,0CAU3BwD,YAV2B,gBAUZC,eAVY,gBAWlC;AACA;AACA;AACA;AACA;AAfkC,gBAgBYzD,QAAQ,CAAC,EAAD,CAhBpB,2CAgB3B0D,KAhB2B,gBAgBZC,QAhBY,gCAiBkB3D,QAAQ,CAAC,EAAD,CAjB1B,2CAiB3B4D,QAjB2B,gBAiBTC,WAjBS,gCAkBN7D,QAAQ,CAAC,EAAD,CAlBF,2CAkB3B8D,MAlB2B,gBAkBnBC,SAlBmB,gBAoBlChE,SAAS,CAAC,UAAM,CACdkD,QAAQ,CAAS,CAAC,CAACb,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAeW,KAArC,CAAqDZ,KAAK,CAACC,QAAN,CAAeW,KAApE,CAAqF,EAA9F,CAAR,CACAO,gBAAgB,CAAC,CAAC,CAACnB,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAeiB,aAArC,CAAqDlB,KAAK,CAACC,QAAN,CAAeiB,aAApE,CAAqF,EAAtF,CAAhB,CACAG,eAAe,CAAE,CAAC,CAACrB,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAemB,YAArC,CAAqDpB,KAAK,CAACC,QAAN,CAAemB,YAApE,CAAqF,EAAvF,CAAf,CACA;AACA;AACA;AACA;AACA;AACAL,SAAS,CAAU,CAAC,CAACf,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAe2B,OAArC,CAAuD5B,KAAK,CAACC,QAAN,CAAe2B,OAAtE,CAAqF,EAA/F,CAAT,CACAX,UAAU,CAAU,CAAC,CAACjB,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAe2B,OAArC,CAAuD5B,KAAK,CAACC,QAAN,CAAe2B,OAAtE,CAAqF,EAA/F,CAAV,CACAL,QAAQ,CAAS,CAAC,CAACvB,KAAK,CAACC,QAAR,EAAoB,CAAC,CAACD,KAAK,CAACC,QAAN,CAAeqB,KAArC,CAAqDtB,KAAK,CAACC,QAAN,CAAeqB,KAApE,CAAqF,EAA9F,CAAR,CAED,CAbQ,CAaN,EAbM,CAAT,CAeD3D,SAAS,CAAC,UAAM,CACb,GAAG,CAAC,CAACkE,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAL,CAAkC,CAEhC,GAAIC,CAAAA,GAAG,CAAGC,IAAI,CAACC,KAAL,CAAWJ,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAV,CAEArB,QAAQ,CAAC,CAAD,CAAR,CACAE,WAAW,CAAC,EAAD,CAAX,CAEA,GAAG,CAAC,CAACoB,GAAL,CAAU,CACRA,GAAG,CAACG,OAAJ,CAAa,SAAAC,CAAC,CAAI,CAChB,GAAG,CAAC,CAACA,CAAC,CAACC,GAAP,CACEpC,KAAK,CAACE,QAAN,CAAeQ,QAAf,GAA0B2B,KAA1B,CAAgCF,CAAC,CAACC,GAAlC,EAAuCE,IAAvC,CAA4C,OAA5C,CAAqD,SAACC,QAAD,CAAc,CACjE,GAAGA,QAAQ,CAACC,MAAT,EAAH,CAAsB,CAElB;AACAlC,UAAU,CAACmC,GAAX,GAAiBJ,KAAjB,CAAuBE,QAAQ,CAACG,GAAT,GAAeC,YAAtC,EAAoDC,cAApD,GAAqEC,IAArE,CAA2E,SAACC,GAAD,CAAS,CAElF,GAAIC,CAAAA,OAAO,kBAAOR,QAAQ,CAACG,GAAT,EAAP,EAAuBM,QAAQ,CAACF,GAAhC,CAAqCV,GAAG,CAACG,QAAQ,CAACH,GAAlD,EAAX,CAEAa,OAAO,CAACC,GAAR,CAAYH,OAAO,CAACC,QAApB,EACA,GAAGD,OAAO,CAACI,QAAX,CAAqB,CACnB1C,QAAQ,CAAC,SAAA2C,CAAC,QAAK,CAACA,CAAD,CAAK,EAACL,OAAO,CAACM,KAAnB,EAAF,CAAR,CACA1C,WAAW,CAAC,SAAA2C,CAAC,qCAAQA,CAAR,GAAWP,OAAX,IAAF,CAAX,CACD,CACD;AACD,CAVD,EAUGQ,KAVH,CAUS,SAAAC,GAAG,CAAI,CAEd,GAAIT,CAAAA,OAAO,kBAAOR,QAAQ,CAACG,GAAT,EAAP,EAAuBM,QAAQ,CAAC7E,SAAhC,CAA2CiE,GAAG,CAACG,QAAQ,CAACH,GAAxD,EAAX,CACAa,OAAO,CAACC,GAAR,CAAYH,OAAO,CAACC,QAApB,EACA,GAAGD,OAAO,CAACI,QAAX,CAAqB,CACnB1C,QAAQ,CAAC,SAAA2C,CAAC,QAAIA,CAAAA,CAAC,CAAGL,OAAO,CAACM,KAAhB,EAAF,CAAR,CACA1C,WAAW,CAAC,SAAA2C,CAAC,qCAAQA,CAAR,GAAWP,OAAX,IAAF,CAAX,CACD,CACF,CAlBD,EAmBH,CACF,CAxBD,EAyBD,CA3BH,EA4BD,CACF,CACF,CAvCO,CAuCL,EAvCK,CAAT,CAyCC,GAAMU,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,KAAK,CAAI,CAExB,GAAIC,CAAAA,IAAI,CAAG,CACP/C,KAAK,CAALA,KADO,CAEPM,aAAa,CAAbA,aAFO,CAGPE,YAAY,CAAZA,YAHO,CAIP;AACA;AACA;AACA;AACA;AACAN,SAAS,CAATA,SATO,CAUPE,UAAU,CAAVA,UAVO,CAWPM,KAAK,CAALA,KAXO,CAYPE,QAAQ,CAARA,QAZO,CAAX,CAeAxB,KAAK,CAACE,QAAN,CAAe0D,WAAf,CAA2B5B,IAAI,CAACC,KAAL,CAAWJ,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAA3B,CAAqE6B,IAArE,EACGJ,KADH,CACS,SAACC,GAAD,CAAS,CACdP,OAAO,CAACC,GAAR,CAAYM,GAAZ,EACD,CAHH,EAMA3B,YAAY,CAACgC,OAAb,CAAqB,MAArB,CAA6B7B,IAAI,CAAC8B,SAAL,CAAe,EAAf,CAA7B,EACA9D,KAAK,CAACG,OAAN,CAAc4D,IAAd,CAAmB,GAAnB,EACAL,KAAK,CAACM,cAAN,GAED,CA3BD,CA6BA,MACE,qBAAC,KAAD,CAAO,QAAP,MACE,oBAAC,MAAD,EAAQ,MAAM,CAAC,OAAf,CAAuB,IAAI,CAAEhE,KAAK,CAACiE,IAAnC,CAAyC,OAAO,CAAE,yBAAMhB,CAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,CAAN,EAAlD,EAEA,oBAAC,IAAD,EAAM,EAAE,CAAC,WAAT,iEAFA,CADF,CAQE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAE7C,OAAO,CAAC6D,qBAAnC,EAEE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,2BAAK,SAAS,CAAE7D,OAAO,CAAC6D,qBAAxB,EACE,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,mEADF,CADF,CAFF,CAQE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,4BAAM,QAAQ,CAAET,QAAhB,EACG,CAAC,CAAC/B,MAAF,EAAYA,MAAM,CAACyC,GAAP,CAAW,SAACX,GAAD,CAAMY,EAAN,CAAa,CACnC,MAAO,qBAAC,eAAD,EAAiB,GAAG,CAAEA,EAAtB,CAA0B,KAAK,CAAEZ,GAAjC,EAAP,CACD,CAFY,CADf,CAIE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,EACA,oBAAC,SAAD,EACI,SAAS,KADb,CAEI,MAAM,CAAC,QAFX,CAGI,IAAI,CAAC,YAHT,CAII,KAAK,CAAE5C,KAJX,CAKI,QAAQ,CAAE,kBAACuB,CAAD,QAAOtB,CAAAA,QAAQ,CAACsB,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAf,EALd,CAMI,EAAE,CAAC,YANP,CAOI,KAAK,CAAC,6FAPV,CAQI,IAAI,CAAC,OART,CASI,QAAQ,KATZ,CAUI,SAAS,KAVb,EADA,CAaE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EAEA,oBAAC,SAAD,EACE,IAAI,CAAC,WADP,CAEE,KAAK,CAAEpD,aAFT,CAGE,QAAQ,CAAE,kBAACiB,CAAD,QAAOhB,CAAAA,gBAAgB,CAACgB,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAvB,EAHZ,CAIE,IAAI,CAAC,MAJP,CAKE,SAAS,KALX,CAME,EAAE,CAAC,WANL,CAOE,KAAK,CAAC,qBAPR,CAQE,QAAQ,KARV,CASE,SAAS,KATX,EAFA,CAbF,CA4BE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,oBAAC,SAAD,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAElD,YAFT,CAGE,QAAQ,CAAE,kBAACe,CAAD,QAAOd,CAAAA,eAAe,CAACc,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAtB,EAHZ,CAIE,IAAI,CAAC,MAJP,CAKE,SAAS,KALX,CAME,EAAE,CAAC,UANL,CAOE,KAAK,CAAC,kDAPR,CAQE,QAAQ,KARV,CASE,SAAS,KATX,EADF,CA5BF,CAJF,CA8CE,oBAAC,SAAD,EACI,IAAI,CAAC,UADT,CAEI,KAAK,CAAE9C,QAFX,CAGI,QAAQ,CAAE,kBAACW,CAAD,QAAOV,CAAAA,WAAW,CAACU,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAlB,EAHd,CAII,IAAI,CAAC,MAJT,CAKI,SAAS,KALb,CAMI,EAAE,CAAC,UANP,CAOI,KAAK,CAAC,2EAPV,CAQI,QAAQ,KARZ,CASI,SAAS,KATb,EA9CF,CA0HK,oBAAC,SAAD,EACC,IAAI,CAAC,OADN,CAEC,KAAK,CAAEhD,KAFR,CAGC,QAAQ,CAAE,kBAACa,CAAD,QAAOZ,CAAAA,QAAQ,CAACY,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAf,EAHX,CAIC,SAAS,KAJV,CAKC,MAAM,CAAC,QALR,CAMC,EAAE,CAAC,OANJ,CAOC,KAAK,CAAC,iFAPP,CAQC,IAAI,CAAC,MARN,CASC,QAAQ,KATT,CAUC,SAAS,KAVV,EA1HL,CAuII,oBAAC,SAAD,EACE,IAAI,CAAC,QADP,CAEE,KAAK,CAAExD,SAFT,CAGE,QAAQ,CAAE,kBAACqB,CAAD,QAAOpB,CAAAA,SAAS,CAACoB,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAhB,EAHZ,CAIE,SAAS,KAJX,CAKE,MAAM,CAAC,QALT,CAME,EAAE,CAAC,QANL,CAOE,KAAK,CAAC,iFAPR,CAQE,IAAI,CAAC,MARP,CASE,QAAQ,KATV,EAvIJ,CAmJI,oBAAC,SAAD,EACE,IAAI,CAAC,SADP,CAEE,KAAK,CAAEtD,UAFT,CAGE,QAAQ,CAAE,kBAACmB,CAAD,QAAOlB,CAAAA,UAAU,CAACkB,CAAC,CAACkC,MAAF,CAASC,KAAV,CAAjB,EAHZ,CAIE,SAAS,KAJX,CAKE,MAAM,CAAC,QALT,CAME,EAAE,CAAC,SANL,CAOE,KAAK,CAAC,iFAPR,CAQE,IAAI,CAAC,MARP,CASE,QAAQ,KATV,EAnJJ,CA+JI,oBAAC,MAAD,EAAQ,SAAS,CAAEjE,OAAO,CAACZ,UAA3B,CAAuC,IAAI,CAAC,QAA5C,CAAqD,KAAK,CAAC,SAA3D,qDA/JJ,CADF,CARF,CA8KE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,oBAAC,KAAD,EAAO,SAAS,CAAEY,OAAO,CAAChB,KAA1B,CAAiC,SAAS,CAAE,CAA5C,EACE,oBAAC,IAAD,MACCqB,QAAQ,CAACyD,GAAT,CAAa,SAACI,OAAD,CAAUC,CAAV,QACZ,qBAAC,QAAD,EAAU,SAAS,CAAEnE,OAAO,CAACpB,IAA7B,EACE,oBAAC,IAAD,EAAO,SAAS,KAAhB,CAAiB,OAAO,CAAE,CAA1B,EACE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAG,CAAhB,EACE,2BAAK,GAAG,CAAEsF,OAAO,CAACvB,QAAlB,CAA4B,KAAK,CAAE,MAAnC,CAA2C,MAAM,CAAE,MAAnD,EADF,CADF,CAIE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,EACE,oBAAC,UAAD,UAAeuB,OAAO,CAACE,IAAvB,KADF,CAEE,oBAAC,UAAD,UAAgBF,OAAO,CAACG,KAAxB,KAFF,CAGE,oBAAC,UAAD,UAAeH,OAAO,CAAClB,KAAvB,wBAHF,CAJF,CADF,CADY,EAAb,CADD,CADF,CAiBI,oBAAC,QAAD,MACI,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,iCAAkC7C,KAAlC,2CADJ,CAjBJ,CADF,CA9KF,CARF,CADF,CAqND,CA9TD,CAiUA,cAAeT,CAAAA,YAAf","sourcesContent":["import Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport SingleLineError from '../Error'\nimport {withFirebase} from '../Firebase'\nimport {compose} from 'recompose'\nimport React, { useEffect, useState, useRef } from 'react';\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport NullImage from '../Product/No-Image-Available.jpg';\nimport Typography from '@material-ui/core/Typography';\nimport TextField from '@material-ui/core/TextField';\nimport ListItem from '@material-ui/core/ListItem';\nimport List from '@material-ui/core/List';\nimport Drawer from '@material-ui/core/Drawer';\nimport { CardMedia, Card, CardContent, CardActions } from '@material-ui/core'\n\nimport Button from '@material-ui/core/Button';\nimport { withAuthentication, AuthUserContext } from '../Session';\n\nconst useStyles = makeStyles({\n  grid:{\n    margin:0,\n    padding:0,\n    marginLeft:0,\n  },\n  paper: {\n    marginLeft:40,\n    width: '100%',\n    backgroundColor: \"rgba(0,0,0,0)\",\n  },\n  fullList: {\n    width: 'auto',\n  },\n  cartButton:{\n    marginTop:20,\n    height:47,\n    width:'100%',\n    color: '#FFFFFF',\n    float:'center',\n    backgroundColor: '#00B4F4',\n    borderRadius:0,\n    '&:hover':{\n      backgroundColor: '#D6D6D6'\n    }\n  },\n});\n\n\nconst CheckOutView = compose(withAuthentication, withFirebase)((props) => {\n\n  return(\n   <AuthUserContext.Consumer>\n     {authUser => <CheckOutViewBase authUser={authUser} firebase={props.firebase} history={props.history}/>}\n   </AuthUserContext.Consumer>\n  )\n})\n\nconst CheckOutViewBase = (props) => {\n  const classes = useStyles();\n  const storageRef = props.firebase.storage;\n  const [total, setTotal] = React.useState(0);\n  const [products, setProducts] = React.useState([]);\n\n  const [email, setEmail ]                    = useState('');\n  const [resInDate, setInDate ]                    = useState('');\n  const [resOutDate, setOutDate ]                    = useState('');\n  const [userFirstName, setUserFirstName     ] = useState('');\n  const [userLastName,  setUserLastName      ] = useState('')\n  // const [addressOne,    setAddressOne       ] = useState('');\n  // const [addressTwo,    setAddressTwo       ] = useState('');\n  // const [city,          setCity             ] = useState('');\n  // const [country,       setCountry          ] = useState('');\n  // const [code,          setCode             ] = useState('');\n  const [phone,         setPhone            ] = useState('');\n  const [roomName,         setRoomName            ] = useState('');\n  const [errors, setErorrs] = useState([]);\n\n  useEffect(() => {\n    setEmail        (!!props.authUser && !!props.authUser.email         ? props.authUser.email          : '')\n    setUserFirstName(!!props.authUser && !!props.authUser.userFirstName ? props.authUser.userFirstName  : '') \n    setUserLastName (!!props.authUser && !!props.authUser.userLastName  ? props.authUser.userLastName   : '') \n    // setAddressOne   (!!props.authUser && !!props.authUser.addressOne    ? props.authUser.addressOne     : '') \n    // setAddressTwo   (!!props.authUser && !!props.authUser.addressTwo    ? props.authUser.addressTwo     : '') \n    // setCity         (!!props.authUser && !!props.authUser.city          ? props.authUser.city           : '') \n    // setCountry      (!!props.authUser && !!props.authUser.country       ? props.authUser.country        : '') \n    // setCode         (!!props.authUser && !!props.authUser.code          ? props.authUser.code           : '') \n    setInDate         (!!props.authUser && !!props.authUser.resDate         ? props.authUser.resDate      : '') \n    setOutDate         (!!props.authUser && !!props.authUser.resDate         ? props.authUser.resDate      : '') \n    setPhone        (!!props.authUser && !!props.authUser.phone         ? props.authUser.phone          : '') \n\n  }, [])\n\n useEffect(() => {\n    if(!!localStorage.getItem('cart')){\n\n      let obj = JSON.parse(localStorage.getItem('cart'));\n\n      setTotal(0);\n      setProducts([]);\n\n      if(!!obj) {\n        obj.forEach( e => {\n          if(!!e.key)\n            props.firebase.products().child(e.key).once('value', (snapshot) => {\n              if(snapshot.exists()) {     \n                      \n                  // Try to get url from the storage\n                  storageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then( (url) => { \n\n                    let element = {...snapshot.val(), imageRef:url, key:snapshot.key}\n                    \n                    console.log(element.imageRef);\n                    if(element.isPublic) {\n                      setTotal(t => (+t + +element.price));\n                      setProducts(a => [...a, element])\n                    }                \n                    // if it fails set the url to the default image\n                  }).catch(err => {\n\n                    let element = {...snapshot.val(), imageRef:NullImage, key:snapshot.key}\n                    console.log(element.imageRef);\n                    if(element.isPublic) {\n                      setTotal(t => t + element.price);\n                      setProducts(a => [...a, element])\n                    }\n                  })\n              }\n            });\n          })\n      }\n    }\n  }, [])\n\n  const onSubmit = event => {\n\n    let user = {\n        email,\n        userFirstName,\n        userLastName,\n        // addressOne,\n        // addressTwo,\n        // city,\n        // country,\n        // code,\n        resInDate,\n        resOutDate,\n        phone,\n        roomName,\n    }\n    \n    props.firebase.createOrder(JSON.parse(localStorage.getItem('cart')), user)\n      .catch((err) => {\n        console.log(err)\n      })\n\n\n    localStorage.setItem('cart', JSON.stringify([]));\n    props.history.push('/');\n    event.preventDefault();\n    \n  }\n  \n  return(\n    <React.Fragment>\n      <Drawer anchor=\"right\" open={props.open} onClose={() => console.log(\"cart closed\")}>\n\n      <Link to=\"/checkout\"> \n        Бронювання\n      </Link>\n      </Drawer>\n\n      <Grid container className={classes.returningCustomerText}>\n\n        <Grid item xs={3}>\n          <div className={classes.returningCustomerText}>\n            <Typography variant=\"h5\" > Бронювання </Typography>\n          </div>     \n        </Grid>\n\n        <Grid item xs={4}>      \n          <form onSubmit={onSubmit}>     \n            {!!errors && errors.map((err, id) => {\n              return(<SingleLineError key={id} error={err}/>)\n            })}      \n            <Grid container spacing={2}>\n            <TextField\n                autoFocus          \n                margin=\"normal\"\n                name=\"addressOne\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                id=\"addressOne\"\n                label=\"Електронна пошта\"\n                type=\"email\"\n                required\n                fullWidth\n              />\n              <Grid item xs={6}>\n\n              <TextField\n                name=\"firstName\"\n                value={userFirstName}\n                onChange={(e) => setUserFirstName(e.target.value)}\n                type=\"text\"\n                autoFocus          \n                id=\"firstName\"\n                label=\"Ім'я\"\n                required\n                fullWidth\n\n              />\n              </Grid>\n              <Grid item xs={6}>\n                <TextField\n                  name=\"lastname\"\n                  value={userLastName}\n                  onChange={(e) => setUserLastName(e.target.value)}\n                  type=\"text\"\n                  autoFocus          \n                  id=\"lastname\"\n                  label=\"Прізвище\"\n                  required\n                  fullWidth\n                />\n              </Grid>\n            </Grid>\n            <TextField\n                name=\"roomName\"\n                value={roomName}\n                onChange={(e) => setRoomName(e.target.value)}\n                type=\"text\"\n                autoFocus          \n                id=\"roomName\"\n                label=\"Назва кімнати\"\n                required\n                fullWidth\n\n              />\n            {/* <TextField\n                autoFocus          \n                margin=\"normal\"\n                name=\"addressOne\"\n                value={addressOne}\n                onChange={(e) => setAddressOne(e.target.value)}\n                id=\"addressOne\"\n                label=\"Address 1\"\n                type=\"text\"\n                required\n                fullWidth\n              />\n              <TextField\n                name=\"addressTwo\"\n                value={addressTwo}\n                onChange={(e) => setAddressTwo(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"addressTwo\"\n                label=\"Address 2\"\n                type=\"text\"\n                required\n                fullWidth\n              />\n              <TextField\n                name=\"city\"\n                value={city}\n                onChange={(e) => setCity(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"city\"\n                label=\"City\"\n                type=\"text\"\n                required\n                fullWidth\n              />\n              <TextField\n                name=\"country\"\n                value={country}\n                onChange={(e) => setCountry(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"country\"\n                label=\"Country\"\n                type=\"text\"\n                required\n                fullWidth\n              />\n               <TextField\n                name=\"code\"\n                value={code}\n                onChange={(e) => setCode(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"code\"\n                label=\"code\"\n                type=\"text\"\n                required\n                fullWidth\n              /> */}\n               \n               \n               \n               \n               <TextField\n                name=\"phone\"\n                value={phone}\n                onChange={(e) => setPhone(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"phone\"\n                label=\"Номер Телефону\"\n                type=\"text\"\n                required\n                fullWidth\n              />\n\n              <TextField\n                name=\"indate\"\n                value={resInDate}\n                onChange={(e) => setInDate(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"indate\"\n                label=\"Дата Заселення\"\n                type=\"text\"\n                required\n              />\n\n              <TextField\n                name=\"outdate\"\n                value={resOutDate}\n                onChange={(e) => setOutDate(e.target.value)}\n                autoFocus\n                margin=\"normal\"\n                id=\"outdate\"\n                label=\"Дата виселення\"\n                type=\"text\"\n                required\n              />\n\n              <Button className={classes.cartButton} type=\"submit\" color=\"primary\">\n                Оплатити\n              </Button>\n          </form>\n          </Grid>\n          \n        <Grid item xs={4}>\n          <Paper className={classes.paper} elevation={0}>\n            <List>\n            {products.map((product, i) => (\n              <ListItem className={classes.grid}>\n                <Grid  container spacing={0}>\n                  <Grid item xs ={3}>\n                    <img src={product.imageRef} width={'100%'} height={'100%'}/>\n                  </Grid>\n                  <Grid item xs={9}>\n                    <Typography > {product.name} </Typography>\n                    <Typography  > {product.model} </Typography>\n                    <Typography > {product.price} грн </Typography>\n                  </Grid>\n                </Grid>\n              </ListItem>\n            ))}\n            </List>\n              <ListItem>\n                  <Typography variant=\"h6\"> Ціна : {total} грн/ніч </Typography>\n              </ListItem> \n\n          </Paper>\n        </Grid>\n        \n      </Grid>\n\n    </React.Fragment>\n  );\n\n}\n\n\nexport default CheckOutView;"]},"metadata":{},"sourceType":"module"}