{"ast":null,"code":"import _slicedToArray from \"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/hshchu/Desktop/github/e-commerce/src/components/Navigation/SubCategoryDrawer.js\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { compose } from 'recompose';\nimport { withAuthorization, withAuthentication, AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport TextField from '@material-ui/core/TextField';\nimport SubCategoryDrawer from './SubCategoryDrawer';\nimport NewCategoryButton from './NewCategoryButton';\nimport Logo from \"./logo.svg\";\nimport Typography from '@material-ui/core/Typography';\nimport HighlightOffIcon from '@material-ui/icons/HighlightOff';\nimport Button from '@material-ui/core/Button';\nimport VisibilityOffOutlinedIcon from '@material-ui/icons/VisibilityOffOutlined';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\nimport VisibilityOutlinedIcon from '@material-ui/icons/VisibilityOutlined';\nconst useStyles = makeStyles(theme => ({\n  drawer: {\n    width: 300,\n    flexShrink: 0\n  },\n  drawerPaper: {\n    marginTop: 0,\n    width: 300,\n    backgroundColor: \"#00c3d9\",\n    borderRight: 0\n  },\n  logo: {\n    marginTop: 20,\n    marginRight: 40,\n    marginLeft: 30\n  },\n  navList: {\n    marginTop: 110\n  },\n  link: {\n    textDecoration: \"none\"\n  },\n  navButton: {\n    color: \"#2C2A2B\",\n    marginLeft: 30\n  },\n  adminNavButton: {\n    color: \"#5C5A5B\",\n    marginLeft: 30\n  },\n  icon: {\n    minWidth: 15,\n    miHeight: 15,\n    width: 15,\n    height: 15\n  },\n  buttons: {\n    height: 25,\n    minWidth: 25,\n    width: 25,\n    margin: 0,\n    marginLeft: 5,\n    color: \"#5C5A5B\",\n    borderRadius: 0,\n    '&:hover': {\n      backgroundColor: 'rgba(255,255,255,0)',\n      color: '#AAAAAA'\n    }\n  },\n  link: {\n    textDecoration: \"none\"\n  },\n  tempDrawerPaper: {\n    width: 300,\n    marginLeft: 300,\n    marginTop: 38,\n    backgroundColor: \"rgba(221,221,220, 0.92)\"\n  }\n})); //TODO: [Architecture] Create reusable high order component for retrieving data from firebase \n\nconst SideSubCategoryDrawer = props => {\n  const classes = useStyles();\n  const categoryRef = props.firebase.categoryRef();\n\n  const _React$useState = React.useState([]),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        categories = _React$useState2[0],\n        setCategories = _React$useState2[1];\n\n  const _React$useState3 = React.useState(true),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        open = _React$useState4[0],\n        setOpen = _React$useState4[1];\n\n  const refreshCategories = () => {\n    setCategories([]);\n    let subCategoryRef = categoryRef.child(props.category).child(\"subCategories\");\n    subCategoryRef.once(\"value\", (ss, prevChildKey) => {\n      ss.forEach(snapshot => setCategories(x => [...x, {\n        name: snapshot.key,\n        key: snapshot.key,\n        visible: snapshot.val().visible\n      }]));\n    });\n  };\n\n  useEffect(() => {\n    if (!props.category) return;\n    setCategories([]);\n    let subCategoryRef = categoryRef.child(props.category).child(\"subCategories\");\n    const ca = subCategoryRef.on(\"child_added\", (snapshot, prevChildKey) => {\n      setCategories(x => [...x, {\n        name: snapshot.key,\n        key: snapshot.key,\n        visible: snapshot.val().visible\n      }]);\n    });\n    const cr = subCategoryRef.on(\"child_removed\", snapshot => {\n      refreshCategories();\n    }); //TODO: [Functionality] Update child state\n\n    const cc = subCategoryRef.on(\"child_changed\", snapshot => {\n      refreshCategories();\n    });\n    return () => {\n      subCategoryRef.off(\"child_added\", ca);\n      subCategoryRef.off(\"child_removed\", cr);\n      subCategoryRef.off(\"child_changed\", cc);\n    };\n  }, [props.category]);\n  return React.createElement(Drawer, {\n    open: props.open,\n    variant: \"persistent\",\n    classes: {\n      paper: classes.tempDrawerPaper,\n      modal: classes.modal\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(List, {\n    className: classes.navList,\n    dense: \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, categories.map((category, index) => React.createElement(AuthUserContext.Consumer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, authUser => {\n    if ((!!authUser && !authUser.isAdmin || !!!authUser) && category.visible) return React.createElement(Link, {\n      className: classes.link,\n      to: \"/store/\".concat(props.category, \"/\").concat(category.name, \"/\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(ListItem, {\n      button: true,\n      key: category.key,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"h6\",\n      className: classes.navButton,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \" \", category.name, \" \")));else if (!!authUser && authUser.isAdmin) return React.createElement(Link, {\n      className: classes.link,\n      to: \"/store/\".concat(props.category, \"/\").concat(category.name, \"/\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(ListItem, {\n      button: true,\n      key: category.key,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"h6\",\n      className: classes.navButton,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \" \", category.name, \" \"), React.createElement(ListItemSecondaryAction, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, category.visible && React.createElement(Button, {\n      className: classes.buttons,\n      onClick: e => {\n        props.firebase.setCategoryVisible(props.category, category.name, false);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(VisibilityOutlinedIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    })), !category.visible && React.createElement(Button, {\n      className: classes.buttons,\n      onClick: e => {\n        props.firebase.setCategoryVisible(props.category, category.name, true);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(VisibilityOffOutlinedIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    })), React.createElement(Button, {\n      className: classes.buttons,\n      onClick: e => {\n        props.firebase.deleteCategory(props.category, category.name);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(HighlightOffIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    })))));\n  })), React.createElement(AuthUserContext.Consumer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, authUser => !!authUser && authUser.isAdmin && React.createElement(NewCategoryButton, {\n    category: props.category,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }))));\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, React.createElement(Drawer, {\n    open: props.open,\n    variant: \"persistent\",\n    classes: {\n      paper: classes.tempDrawerPaper,\n      modal: classes.modal\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, React.createElement(List, {\n    class: classes.navList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, categories.map((category, index) => React.createElement(Link, {\n    key: category.name,\n    to: \"/store/\".concat(props.category, \"/\").concat(category.name, \"/\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(ListItem, {\n    button: true,\n    key: category.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, React.createElement(ListItemText, {\n    primary: category.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  })))), React.createElement(NewCategoryButton, {\n    category: props.category,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }))));\n};\n\nexport default compose(withAuthentication)(SideSubCategoryDrawer);","map":{"version":3,"sources":["/Users/hshchu/Desktop/github/e-commerce/src/components/Navigation/SubCategoryDrawer.js"],"names":["React","useEffect","useState","useRef","BrowserRouter","Router","Link","Route","makeStyles","compose","withAuthorization","withAuthentication","AuthUserContext","withFirebase","ClickAwayListener","Drawer","List","Divider","ListItem","ListItemText","TextField","SubCategoryDrawer","NewCategoryButton","Typography","HighlightOffIcon","Button","VisibilityOffOutlinedIcon","ListItemIcon","ListItemSecondaryAction","IconButton","VisibilityOutlinedIcon","useStyles","theme","drawer","width","flexShrink","drawerPaper","marginTop","backgroundColor","borderRight","logo","marginRight","marginLeft","navList","link","textDecoration","navButton","color","adminNavButton","icon","minWidth","miHeight","height","buttons","margin","borderRadius","tempDrawerPaper","SideSubCategoryDrawer","props","classes","categoryRef","firebase","categories","setCategories","open","setOpen","refreshCategories","subCategoryRef","child","category","once","ss","prevChildKey","forEach","snapshot","x","name","key","visible","val","ca","on","cr","cc","off","paper","modal","map","index","authUser","isAdmin","e","setCategoryVisible","deleteCategory"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { compose } from 'recompose'\nimport { withAuthorization, withAuthentication, AuthUserContext } from '../Session'\nimport { withFirebase } from '../Firebase'\n\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\n\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport TextField from '@material-ui/core/TextField';\nimport SubCategoryDrawer from './SubCategoryDrawer'\nimport NewCategoryButton from './NewCategoryButton'\nimport Logo from './logo.svg'\nimport Typography from '@material-ui/core/Typography';\nimport HighlightOffIcon from '@material-ui/icons/HighlightOff';\nimport Button from '@material-ui/core/Button'\nimport VisibilityOffOutlinedIcon from '@material-ui/icons/VisibilityOffOutlined';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\nimport VisibilityOutlinedIcon from '@material-ui/icons/VisibilityOutlined';\n\n\nconst useStyles = makeStyles(theme => ({\n\n  drawer:{\n    width:300,\n    flexShrink:0,\n\n  },\n  drawerPaper:{\n    marginTop:0,\n    width:300,\n    backgroundColor:\"#00c3d9\",\n    borderRight:0,\n  },\n  logo:{\n    marginTop:20,\n    marginRight:40,\n    marginLeft:30,\n  },\n  navList:{\n    marginTop:110,\n\n  },\n  link:{\n    textDecoration:\"none\",\n  },\n  navButton:{\n    color:\"#2C2A2B\",\n    marginLeft:30\n  },\n  adminNavButton:{\n    color:\"#5C5A5B\",\n    marginLeft:30\n  },\n  icon:{\n    minWidth:15,\n    miHeight:15,\n    width:15,\n    height:15,\n  },\n  buttons:{\n    height:25,\n    minWidth:25,\n    width:25,\n    margin:0,\n    marginLeft:5,\n    color: \"#5C5A5B\",\n    borderRadius:0,\n    '&:hover':{\n      backgroundColor: 'rgba(255,255,255,0)',\n      color: '#AAAAAA'\n    }\n  },\n  link:{\n    textDecoration:\"none\"\n  },\n  tempDrawerPaper:{\n    width:300,\n    marginLeft:300,\n    marginTop:38,\n    backgroundColor:\"rgba(221,221,220, 0.92)\"\n  },\n}));\n\n\n//TODO: [Architecture] Create reusable high order component for retrieving data from firebase \n\n\nconst SideSubCategoryDrawer = (props) => {\n  const classes = useStyles();\n\n  const categoryRef = props.firebase.categoryRef();\n\n  const [categories, setCategories] = React.useState([])\n  const [open, setOpen] = React.useState(true);\n\n\n  const refreshCategories = () => {\n\n    setCategories([]);\n\n    let subCategoryRef = categoryRef.child(props.category).child(\"subCategories\");\n\n    subCategoryRef.once(\"value\", (ss, prevChildKey) => {\n      ss.forEach((snapshot) => setCategories(x => [...x, {name:snapshot.key, key:snapshot.key, visible:snapshot.val().visible}]))\n            \n    })\n  }\n\n  useEffect( () => {\n\n    if(!props.category) return;\n    \n    setCategories([]);\n\n    let subCategoryRef = categoryRef.child(props.category).child(\"subCategories\");\n\n    const ca = subCategoryRef.on(\"child_added\", (snapshot, prevChildKey) => {\n      setCategories(x => [...x, {name:snapshot.key, key:snapshot.key, visible:snapshot.val().visible}])      \n    })\n\n    const cr = subCategoryRef.on(\"child_removed\", (snapshot) => {\n      refreshCategories();\n    })\n\n    //TODO: [Functionality] Update child state\n    const cc = subCategoryRef.on(\"child_changed\", (snapshot) => {\n      refreshCategories();\n    })\n\n    return () => {\n      subCategoryRef.off(\"child_added\", ca);\n      subCategoryRef.off(\"child_removed\", cr);\n      subCategoryRef.off(\"child_changed\", cc);\n    }\n\n  }, [props.category]);\n\n  return(\n    <Drawer open={props.open} variant=\"persistent\"\n    classes={{\n            paper: classes.tempDrawerPaper,\n            modal: classes.modal\n          }}>\n            <List className={classes.navList} dense=\"true\">\n              { categories.map((category, index) => (\n                <AuthUserContext.Consumer>\n                  {authUser => {\n                    if(((!!authUser && !authUser.isAdmin) || (!!!authUser)) && category.visible)\n                      return(\n\n                        <Link className={classes.link} to={`/store/${props.category}/${category.name}/`}>\n                          <ListItem button key={category.key}>\n                            \n                            \n                            <Typography variant=\"h6\" className={classes.navButton} > {category.name} </Typography>  \n                            \n                          </ListItem>\n                        </Link>\n\n                      ) \n                    else if(!!authUser && authUser.isAdmin)\n                      return(\n                        \n                        <Link  className={classes.link} to={`/store/${props.category}/${category.name}/`}>\n                          <ListItem button key={category.key}>\n                            \n                            <Typography variant=\"h6\" className={classes.navButton} > {category.name} </Typography>\n                            \n\n                              <ListItemSecondaryAction>\n                                {category.visible && <Button className={classes.buttons} onClick={(e) => {props.firebase.setCategoryVisible(props.category, category.name, false)}}>\n                                <VisibilityOutlinedIcon />\n                              \n                            </Button>}\n\n                            {!category.visible && <Button className={classes.buttons} onClick={(e) => {props.firebase.setCategoryVisible(props.category, category.name, true)}} >\n                            <VisibilityOffOutlinedIcon />\n                            </Button>}\n\n                            <Button className={classes.buttons} onClick={(e) => {props.firebase.deleteCategory(props.category, category.name)}} >\n                              <HighlightOffIcon />\n                            </Button>\n\n                            </ListItemSecondaryAction> \n                          </ListItem>\n                          </Link>                                                                       \n                      )\n                  }}\n                </AuthUserContext.Consumer>\n              ))}\n              <AuthUserContext.Consumer>   \n                {authUser => !!authUser && authUser.isAdmin && <NewCategoryButton category={props.category}/> }                \n              </AuthUserContext.Consumer> \n            </List>\n    </Drawer>\n  )\n\n  return (\n  <div>\n    <Drawer open={props.open} variant=\"persistent\"\n    classes={{\n            paper: classes.tempDrawerPaper,\n            modal: classes.modal\n          }}>\n\n      <List class={classes.navList}>\n        {categories.map((category, index) => (                          \n          <Link key={category.name} to={`/store/${props.category}/${category.name}/`}> \n            <ListItem button key={category.name}>\n              <ListItemText primary={category.name} />\n            </ListItem>\n          </Link>\n          \n        ))}\n        <NewCategoryButton category={props.category}/>\n      </List>\n\n\n    </Drawer>\n  </div>)\n}\n\n\nexport default compose(withAuthentication)(SideSubCategoryDrawer);"]},"metadata":{},"sourceType":"module"}