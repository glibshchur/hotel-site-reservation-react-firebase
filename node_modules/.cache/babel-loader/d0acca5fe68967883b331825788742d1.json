{"ast":null,"code":"import _toConsumableArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useState,useEffect,isValidElement}from'react';import TextField from'@material-ui/core/TextField';import Button from'@material-ui/core/Button';import{DropzoneArea}from'material-ui-dropzone';import Checkbox from'@material-ui/core/Checkbox';import{withFirebase}from'../../Firebase';import{compose}from'recompose';import Grid from'@material-ui/core/Grid';import{withAuthorization,withAuthentication}from'../../Session';import{makeStyles}from'@material-ui/styles';import Autocomplete from'@material-ui/lab/Autocomplete';import{debug}from'util';import FormGroup from'@material-ui/core/FormGroup';import FormControlLabel from'@material-ui/core/FormControlLabel';import FormControl from'@material-ui/core/FormControl';import FormLabel from'@material-ui/core/FormLabel';import SingleLineError from'../../Error';import{Typography}from'@material-ui/core';import{render}from'react-dom';var useStyles=makeStyles(function(theme){return{upload:{border:\"1px solid black\"},spacer:{height:20},errorDiv:{marginTop:55},title:{marginTop:50,marginBottom:50},signInButton:{height:47,width:80,marginTop:20,marginBottom:150,color:'#FFFFFF',backgroundColor:'#00B4F4',borderRadius:0,'&:hover':{backgroundColor:'#D6D6D6'}}};});var CreateProduct=function CreateProduct(props){var classes=useStyles();var categoryRef=props.firebase.categoryRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),category=_useState2[0],setCategory=_useState2[1];// not '', len < 50\nvar _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),subCategory=_useState4[0],setSubCategory=_useState4[1];// not '', len < 50\nvar _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];// not '', len < 50\nvar _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),tags=_useState8[0],setTags=_useState8[1];// len < 500\nvar _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),description=_useState10[0],setDescription=_useState10[1];// not '', len < 1000\nvar _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),details=_useState12[0],setDetails=_useState12[1];// no validation, len < 1000\nvar _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),price=_useState14[0],setPrice=_useState14[1];// > 0\nvar _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),previewImage=_useState16[0],setPreviewImage=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),subImageOne=_useState18[0],setSubImageOne=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),subImageTwo=_useState20[0],setSubImageTwo=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isPublic=_useState22[0],setIsPublic=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),model=_useState24[0],setModel=_useState24[1];// len < 50\nvar _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),categories=_React$useState2[0],setCategories=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),subCategories=_React$useState4[0],setSubCategories=_React$useState4[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),errors=_React$useState6[0],setErrors=_React$useState6[1];var onSubmit=function onSubmit(event){setErrors([]);var _errors=[];if(category.length>50)_errors.push('Category should be less than 50 characters');if(subCategory.length>50)_errors.push('Sub category should be less than 50 characters');if(name.length>50)_errors.push('Name should be less than 50 characters');if(tags.length>500)_errors.push('Tags should be less than 500 characters');if(category.length>50)_errors.push('Category should be less than 50 characters');if(description.length>1000)_errors.push('Description should be less than 1000 characters');if(details.length>1000)_errors.push('Details should be less than 1000 characters');if(price<0)_errors.push('Price should be a non negative number');if(model.length>50)_errors.push('Model should be less than 50 characters');setErrors(_errors);if(_errors.length>0)return;props.firebase.createProduct({category:category,subCategory:subCategory,tags:tags,name:name,description:description,details:details,price:price,previewImage:previewImage,subImageOne:subImageOne,subImageTwo:subImageTwo,isPublic:isPublic,model:model}).then(function(x){return props.history.push(\"/store/\".concat(category,\"/\").concat(subCategory));}).catch(function(err){return setErrors([err.message]);});//setErrors([\"Something went wrong when trying to create new product\"])) \nevent.preventDefault();};// Update autocomplete when category changes\n// This event is fired when user selects autocomplete option\nvar onCategorySelect=function onCategorySelect(event,val){setSubCategories([]);setCategory(val);categories.forEach(function(x){if(x.name===val&&!!x.subCategories){setSubCategories(Object.keys(x.subCategories));}});};//This event fires when user writes in the autocomplete textbox\nvar onCategoryChange=function onCategoryChange(event){setSubCategories([]);var val=event.target.value;setCategory(val);categories.forEach(function(x){if(x.name===val&&!!x.subCategories){setSubCategories(Object.keys(x.subCategories));}});};useEffect(function(){var ca=categoryRef.on(\"child_added\",function(snapshot,prevChildKey){setCategories(function(x){return[].concat(_toConsumableArray(x),[{name:snapshot.key,key:snapshot.key,subCategories:snapshot.val().subCategories}]);});});var cr=categoryRef.on(\"child_removed\",function(snapshot){setCategories(function(x){return x.filter(function(e){return e!==snapshot.key;});});});return function(){categoryRef.off(\"child_added\",ca);categoryRef.off(\"child_removed\",cr);};},[]);return React.createElement(React.Fragment,null,React.createElement(Typography,{className:classes.title,variant:\"h5\"},\" \\u0414\\u043E\\u0434\\u0430\\u0442\\u0438 \\u043D\\u043E\\u0432\\u0438\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440 \"),React.createElement(\"form\",{onSubmit:onSubmit},React.createElement(Grid,{container:true,spacing:5},React.createElement(Grid,{item:true,xs:6,spacing:5},React.createElement(DropzoneArea,{className:classes.upload,filesLimit:1,dropzoneText:\"\\u0414\\u043E\\u0434\\u0430\\u0439\\u0442\\u0435 \\u0444\\u043E\\u0442\\u043E\",onChange:function onChange(file){return setPreviewImage(file);}}),React.createElement(Grid,{item:true,xs:12},React.createElement(\"div\",{className:classes.spacer},\" \")),React.createElement(Grid,{container:true,spacing:2},React.createElement(Grid,{item:true,xs:6},React.createElement(DropzoneArea,{className:classes.upload,dropzoneText:\"\\u0414\\u043E\\u0434\\u0430\\u0439\\u0442\\u0435 \\u0444\\u043E\\u0442\\u043E\",onChange:function onChange(file){return setSubImageOne(file);}})),React.createElement(Grid,{item:true,xs:6},React.createElement(DropzoneArea,{className:classes.upload,dropzoneText:\"\\u0414\\u043E\\u0434\\u0430\\u0439\\u0442\\u0435 \\u0444\\u043E\\u0442\\u043E\",onChange:function onChange(file){return setSubImageTwo(file);}}))),React.createElement(\"div\",{className:classes.verticalSpacer},!!errors&&errors.map(function(e,i){return React.createElement(SingleLineError,{key:i,error:e});}))),React.createElement(Grid,{item:true,xs:5},React.createElement(Grid,{container:true,spacing:5},React.createElement(Grid,{item:true,xs:6},React.createElement(Autocomplete,{freeSolo:true,id:\"category\",options:categories.map(function(category){return category.name;}),onChange:onCategorySelect,renderInput:function renderInput(params){return React.createElement(TextField,Object.assign({autoFocus:true},params,{margin:\"normal\",name:\"category\",id:\"category\",label:\"\\u041A\\u043E\\u043C\\u043F\\u043B\\u0435\\u043A\\u0441\",value:category,onChange:onCategoryChange,fullWidth:true}));}})),React.createElement(Grid,{item:true,xs:6},React.createElement(Autocomplete,{freeSolo:true,id:\"category\",options:subCategories.map(function(category){return category;}),onChange:function onChange(e,v){setSubCategory(v);},renderInput:function renderInput(params){return React.createElement(TextField,Object.assign({autoFocus:true},params,{margin:\"normal\",name:\"subCategory\",id:\"subCategory\",label:\"\\u0413\\u043E\\u0442\\u0435\\u043B\\u044C\",value:subCategory,onChange:function onChange(e){return setSubCategory(e.target.value);},fullWidth:true}));}}))),React.createElement(Grid,{container:true,spacing:5},React.createElement(Grid,{item:true,xs:6},React.createElement(TextField,{autoFocus:true,margin:\"normal\",name:\"name\",id:\"name\",label:\"\\u041D\\u0430\\u0437\\u0432\\u0430\",value:name,onChange:function onChange(e){return setName(e.target.value);},fullWidth:true}))),React.createElement(TextField,{autoFocus:true,margin:\"normal\",name:\"description\",multiline:true,rows:8,id:\"description\",label:\"\\u041E\\u043F\\u0438\\u0441\",value:description,onChange:function onChange(e){return setDescription(e.target.value);},fullWidth:true}),React.createElement(TextField,{autoFocus:true,margin:\"normal\",name:\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0456\",multiline:true,rows:6,id:\"details\",label:\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0456\",value:details,onChange:function onChange(e){return setDetails(e.target.value);},fullWidth:true}),React.createElement(TextField,{autoFocus:true,margin:\"normal\",name:\"price\",id:\"price\",label:\"\\u0426\\u0456\\u043D\\u0430\",type:\"number\",value:price,onChange:function onChange(e){return setPrice(e.target.value);},fullWidth:true}),React.createElement(\"div\",null,React.createElement(FormControlLabel,{value:\"bottom\",control:React.createElement(Checkbox,{color:\"primary\",checked:isPublic,onChange:function onChange(e){return setIsPublic(e.target.checked);}}),label:\"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0456\\u043A\\u0443\\u0432\\u0430\\u0442\\u0438 \",labelPlacement:\"left\"})),React.createElement(Button,{type:\"submit\",className:classes.signInButton},\" \\u0414\\u043E\\u0434\\u0430\\u0442\\u0438 \")))));};var condition=function condition(authUser){return!!authUser&&authUser.isAdmin;};export default compose(withAuthentication,withAuthorization,withFirebase)(CreateProduct);","map":{"version":3,"sources":["/Users/hshchu/Desktop/github/e-commerce/src/components/Product/Create/index.js"],"names":["React","Component","useState","useEffect","isValidElement","TextField","Button","DropzoneArea","Checkbox","withFirebase","compose","Grid","withAuthorization","withAuthentication","makeStyles","Autocomplete","debug","FormGroup","FormControlLabel","FormControl","FormLabel","SingleLineError","Typography","render","useStyles","theme","upload","border","spacer","height","errorDiv","marginTop","title","marginBottom","signInButton","width","color","backgroundColor","borderRadius","CreateProduct","props","classes","categoryRef","firebase","category","setCategory","subCategory","setSubCategory","name","setName","tags","setTags","description","setDescription","details","setDetails","price","setPrice","previewImage","setPreviewImage","subImageOne","setSubImageOne","subImageTwo","setSubImageTwo","isPublic","setIsPublic","model","setModel","categories","setCategories","subCategories","setSubCategories","errors","setErrors","onSubmit","event","_errors","length","push","createProduct","then","x","history","catch","err","message","preventDefault","onCategorySelect","val","forEach","Object","keys","onCategoryChange","target","value","ca","on","snapshot","prevChildKey","key","cr","filter","e","off","file","verticalSpacer","map","i","params","v","checked","condition","authUser","isAdmin"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect, isValidElement } from 'react';\n\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport {DropzoneArea} from 'material-ui-dropzone'\n\nimport Checkbox from '@material-ui/core/Checkbox'\nimport { withFirebase } from '../../Firebase';\nimport { compose } from 'recompose';\nimport Grid from '@material-ui/core/Grid'\nimport { withAuthorization, withAuthentication } from '../../Session';\nimport { makeStyles } from '@material-ui/styles';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { debug } from 'util';\n\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport SingleLineError from '../../Error'\nimport { Typography } from '@material-ui/core';\nimport { render } from 'react-dom';\n\nconst useStyles = makeStyles(theme => ({\n  upload:{\n    border : \"1px solid black\"\n  },\n  spacer:{\n    height:20\n  },\n  errorDiv:{\n    marginTop:55,\n  },\n  title:{\n    marginTop:50,\n    marginBottom:50,\n  },\n  signInButton:{\n    height:47,\n    width:80,\n    marginTop:20,\n    marginBottom:150,\n    color: '#FFFFFF',\n    backgroundColor: '#00B4F4',\n    borderRadius:0,\n    '&:hover':{\n      backgroundColor: '#D6D6D6'\n    }\n  }\n}));\n\nconst CreateProduct = (props) => {\n\n  const classes = useStyles();\n  const categoryRef = props.firebase.categoryRef();\n\n  const [category, setCategory] = useState('');                   // not '', len < 50\n  const [subCategory, setSubCategory] = useState('');             // not '', len < 50\n  const [name, setName] = useState('');                           // not '', len < 50\n  const [tags, setTags] = useState('');                           // len < 500\n  const [description, setDescription] = useState('');             // not '', len < 1000\n  const [details, setDetails] = useState('');                     // no validation, len < 1000\n  const [price, setPrice] = useState(0);                          // > 0\n  const [previewImage, setPreviewImage] = useState(null);         \n  const [subImageOne, setSubImageOne] = useState(null);           \n  const [subImageTwo, setSubImageTwo] = useState(null);           \n  const [isPublic, setIsPublic] = useState(false)\n  const [model, setModel] = useState('');  // len < 50\n  const [categories, setCategories] = React.useState([])\n  const [subCategories, setSubCategories] = React.useState([]);\n  const [errors, setErrors] = React.useState([]);\n\n\n\n  const onSubmit = event => {\n\n    setErrors([]);\n\n    let _errors = [];\n\n    if(category.length > 50) _errors.push('Category should be less than 50 characters');\n    if(subCategory.length > 50) _errors.push('Sub category should be less than 50 characters');\n    if(name.length > 50) _errors.push('Name should be less than 50 characters');\n    if(tags.length > 500) _errors.push('Tags should be less than 500 characters');\n    if(category.length > 50) _errors.push('Category should be less than 50 characters');\n    if(description.length > 1000) _errors.push('Description should be less than 1000 characters');\n    if(details.length > 1000) _errors.push('Details should be less than 1000 characters');\n    if(price < 0) _errors.push('Price should be a non negative number');\n    if(model.length > 50) _errors.push('Model should be less than 50 characters');\n\n    setErrors(_errors);\n\n    if(_errors.length > 0) return;\n    \n    props.firebase.createProduct({\n      category,\n      subCategory,\n      tags,\n      name,\n      description,\n      details,\n      price,\n      previewImage,\n      subImageOne,\n      subImageTwo,\n      isPublic,\n      model\n    })\n    .then(x => props.history.push(`/store/${category}/${subCategory}`))\n    .catch(err => setErrors([err.message]))//setErrors([\"Something went wrong when trying to create new product\"])) \n\n    event.preventDefault();\n  }\n\n\n  // Update autocomplete when category changes\n  // This event is fired when user selects autocomplete option\n  const onCategorySelect = (event, val) => {\n    setSubCategories([]);\n    setCategory(val);\n    categories.forEach(x => {\n      if(x.name === val && !!x.subCategories){\n        setSubCategories( Object.keys(x.subCategories) )       \n      }\n    })\n  }\n  //This event fires when user writes in the autocomplete textbox\n  const onCategoryChange = (event) => {\n    setSubCategories([]);\n    \n    let val = event.target.value;\n    setCategory(val);\n    categories.forEach(x => {\n      if(x.name === val && !!x.subCategories){\n        setSubCategories( Object.keys(x.subCategories) )\n      }\n    })\n  }\n\n\n  useEffect( () => {\n    const ca = categoryRef.on(\"child_added\", (snapshot, prevChildKey) => {    \n      setCategories(x => [...x, {name:snapshot.key, key:snapshot.key, subCategories:snapshot.val().subCategories}])      \n    })\n\n    const cr = categoryRef.on(\"child_removed\", (snapshot) => {\n      setCategories(x => x.filter(e => e !== snapshot.key) )\n    })\n\n    return () => {\n      categoryRef.off(\"child_added\", ca);\n      categoryRef.off(\"child_removed\", cr);\n    }\n  }, [])\n\n\n\n\n  return(\n    <React.Fragment>\n\n      <Typography className={classes.title} variant=\"h5\"> Додати новий номер </Typography>\n\n      <form onSubmit={onSubmit}>\n        <Grid container spacing={5} >\n   \n          <Grid item xs={6} spacing={5}>\n            <DropzoneArea className={classes.upload} filesLimit={1} dropzoneText=\"Додайте фото\" onChange={(file) => setPreviewImage(file)}/>\n            <Grid item xs={12}>\n              <div className={classes.spacer}> </div>\n            </Grid>\n            <Grid container spacing={2}>\n            \n                <Grid item xs={6}>\n                  <DropzoneArea className={classes.upload} dropzoneText=\"Додайте фото\" onChange={(file) => setSubImageOne(file)}/>\n                </Grid>\n                <Grid item xs={6}>\n                  <DropzoneArea className={classes.upload} dropzoneText=\"Додайте фото\" onChange={(file) => setSubImageTwo(file)}/>\n                </Grid>\n              \n            </Grid>\n\n            <div className={classes.verticalSpacer}>\n              {!!errors && errors.map((e, i) => <SingleLineError key={i} error={e}/>)}\n            </div>\n\n            \n\n          </Grid>\n\n          <Grid item xs={5}>\n            <Grid container spacing={5}>\n              <Grid item xs={6}>\n                <Autocomplete \n                  freeSolo\n                  id=\"category\"\n                  options={categories.map(category => category.name)}\n                  onChange={onCategorySelect}\n                  renderInput={params => (\n                    <TextField autoFocus  \n                    {...params}        \n                    margin=\"normal\"\n                    name=\"category\"\n                    id=\"category\"\n                    label=\"Комплекс\"\n                    value={category}\n                    onChange={onCategoryChange}     \n                    fullWidth\n                    />\n                  )}\n                />\n              </Grid>\n              <Grid item xs={6}>\n              <Autocomplete \n                  freeSolo\n                  id=\"category\"\n                  options={subCategories.map(category => category)}\n                  onChange={(e,v) => {setSubCategory(v)}}\n                  renderInput={params => (\n                    <TextField autoFocus  \n                    {...params}        \n                    margin=\"normal\"\n                    name=\"subCategory\"\n                    id=\"subCategory\"\n                    label=\"Готель\"\n                    value={subCategory}\n                    onChange={(e) => setSubCategory(e.target.value)}     \n                    fullWidth\n                    />\n                  )}\n                />\n              </Grid>\n            </Grid>\n\n          \n                  \n              <Grid container spacing={5}>\n                <Grid item xs={6}>                      \n                  <TextField autoFocus          \n                    margin=\"normal\"\n                    name=\"name\"\n                    id=\"name\"\n                    label=\"Назва\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    \n                    fullWidth\n                  />\n                </Grid>\n                \n              </Grid> \n\n          <TextField autoFocus          \n            margin=\"normal\"\n            name=\"description\"\n            multiline\n            rows={8}\n            id=\"description\"\n            label=\"Опис\"\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            fullWidth\n          />\n\n          <TextField autoFocus          \n            margin=\"normal\"\n            name=\"Деталі\"\n            multiline\n            rows={6}\n            id=\"details\"\n            label=\"Деталі\"\n            value={details}\n            onChange={(e) => setDetails(e.target.value)}\n            \n            fullWidth\n          />\n\n          {/* <TextField autoFocus          \n            margin=\"normal\"\n            name=\"tags\"\n            id=\"tags\"\n            label=\"Tag (max 500 char)\"\n            value={tags}\n            onChange={(e) => setTags(e.target.value)}\n            multiline\n            fullWidth\n          />\n           */}\n          <TextField autoFocus          \n            margin=\"normal\"\n            name=\"price\"\n            id=\"price\"\n            label=\"Ціна\"\n            type=\"number\"\n            value={price}\n            onChange={(e) => setPrice(e.target.value)}         \n            fullWidth\n          />\n          <div>\n            <FormControlLabel\n            value=\"bottom\"\n            control={<Checkbox color=\"primary\" checked={isPublic} onChange={(e) => setIsPublic(e.target.checked)}/>}\n            label=\"Опублікувати \"\n            labelPlacement=\"left\"\n            />\n          </div>\n\n          <Button type=\"submit\" className={classes.signInButton}> Додати </Button>\n          </Grid>\n        \n        </Grid>\n      </form>\n    </React.Fragment>\n  );\n}\n\nconst condition = authUser => !!authUser && authUser.isAdmin;\n\nexport default compose(withAuthentication, withAuthorization, withFirebase)(CreateProduct);"]},"metadata":{},"sourceType":"module"}