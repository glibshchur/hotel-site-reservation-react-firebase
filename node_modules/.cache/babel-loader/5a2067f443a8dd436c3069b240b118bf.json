{"ast":null,"code":"import _toConsumableArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useEffect,useState,useRef}from'react';import{makeStyles}from'@material-ui/core/styles';import{compose}from'recompose';import{withFirebase}from'../Firebase';import{BrowserRouter as Router,Link,Route}from'react-router-dom';import NullImage from'../Product/No-Image-Available.jpg';import NullImage1 from'../Product/ni.jpeg';import Drawer from'@material-ui/core/Drawer';import ListItem from'@material-ui/core/ListItem';import List from'@material-ui/core/List';import Paper from'@material-ui/core/Paper';import{Grid,Typography,CardMedia,Card,CardContent,CardActions,Button}from'@material-ui/core';var useStyles=makeStyles({link:{textDecoration:\"none\"},grid:{margin:0,padding:0,marginLeft:0},paper:{width:400},fullList:{width:'auto'},cartButton:{height:47,width:'100%',color:'#FFFFFF',float:'center',backgroundColor:'#00B4F4',borderRadius:0,'&:hover':{backgroundColor:'#D6D6D6'}}});var CartDrawer=function CartDrawer(props){var classes=useStyles();var storageRef=props.firebase.storage;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),total=_React$useState2[0],setTotal=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),products=_React$useState4[0],setProducts=_React$useState4[1];useEffect(function(){if(props.open&&!!localStorage.getItem('cart')){var obj=JSON.parse(localStorage.getItem('cart'));setTotal(0);setProducts([]);if(!!obj){obj.forEach(function(e){if(!!e.key)props.firebase.products().child(e.key).once('value',function(snapshot){if(snapshot.exists()){// Try to get url from the storage\nstorageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then(function(url){var element=_objectSpread({},snapshot.val(),{imageRef:url,key:snapshot.key});console.log(element.imageRef);if(element.isPublic){setTotal(function(t){return+t+ +element.price;});setProducts(function(a){return[].concat(_toConsumableArray(a),[element]);});}// if it fails set the url to the default image\n}).catch(function(err){var element=_objectSpread({},snapshot.val(),{imageRef:NullImage1,key:snapshot.key});if(element.isPublic){setTotal(function(t){return t+element.price;});setProducts(function(a){return[].concat(_toConsumableArray(a),[element]);});}});}});});}}},[props.open]);return React.createElement(React.Fragment,null,React.createElement(Drawer,{anchor:\"right\",open:props.open,onClose:function onClose(){return console.log(\"cart closed\");}},React.createElement(Paper,{className:classes.paper},React.createElement(List,null,products.map(function(product,i){return React.createElement(ListItem,{className:classes.grid},React.createElement(Grid,{container:true,spacing:0},React.createElement(Grid,{item:true,xs:3},React.createElement(\"img\",{src:product.imageRef,width:'100%',height:'100%'})),React.createElement(Grid,{item:true,xs:9},React.createElement(Typography,null,\" \",product.name,\" \"),React.createElement(Typography,null,\" \",product.model,\" \"),React.createElement(Typography,null,\" \",product.price,\" \\u0433\\u0440\\u043D \"))));})),React.createElement(ListItem,null,React.createElement(Typography,{variant:\"h6\"},\"\\u0412\\u0441\\u044C\\u043E\\u0433\\u043E: \",total,\" \\u0433\\u0440\\u043D\")),React.createElement(Link,{to:\"/checkout\",className:classes.link},React.createElement(Button,{className:classes.cartButton},\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u0438\")))));};var CartItem=function CartItem(props){};export default compose(withFirebase)(CartDrawer);","map":{"version":3,"sources":["/Users/hshchu/Desktop/github/e-commerce/src/components/Cart/index.js"],"names":["React","useEffect","useState","useRef","makeStyles","compose","withFirebase","BrowserRouter","Router","Link","Route","NullImage","NullImage1","Drawer","ListItem","List","Paper","Grid","Typography","CardMedia","Card","CardContent","CardActions","Button","useStyles","link","textDecoration","grid","margin","padding","marginLeft","paper","width","fullList","cartButton","height","color","float","backgroundColor","borderRadius","CartDrawer","props","classes","storageRef","firebase","storage","total","setTotal","products","setProducts","open","localStorage","getItem","obj","JSON","parse","forEach","e","key","child","once","snapshot","exists","ref","val","previewImage","getDownloadURL","then","url","element","imageRef","console","log","isPublic","t","price","a","catch","err","map","product","i","name","model","CartItem"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { compose } from 'recompose'\nimport { withFirebase } from '../Firebase'\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport NullImage from '../Product/No-Image-Available.jpg';\nimport NullImage1 from '../Product/ni.jpeg';\nimport Drawer from '@material-ui/core/Drawer';\nimport ListItem from '@material-ui/core/ListItem';\nimport List from '@material-ui/core/List';\nimport Paper from '@material-ui/core/Paper';\nimport { Grid, Typography, CardMedia, Card, CardContent, CardActions, Button } from '@material-ui/core'\n\nconst useStyles = makeStyles({\n  link:{\n    textDecoration:\"none\"\n  },\n  grid:{\n    margin:0,\n    padding:0,\n    marginLeft:0,\n  },\n  paper: {\n    width: 400,\n  },\n  fullList: {\n    width: 'auto',\n  },\n  cartButton:{\n    height:47,\n    width:'100%',\n    color: '#FFFFFF',\n    float:'center',\n    backgroundColor: '#00B4F4',\n    borderRadius:0,\n    '&:hover':{\n      backgroundColor: '#D6D6D6'\n    }\n  },\n  \n});\n\n\nconst CartDrawer = (props) => {\n  const classes = useStyles();\n  const storageRef = props.firebase.storage;\n\n  const [total, setTotal] = React.useState(0);\n  const [products, setProducts] = React.useState([]);\n\n  useEffect(() => {\n    if(props.open && !!localStorage.getItem('cart')){\n\n      let obj = JSON.parse(localStorage.getItem('cart'));\n      setTotal(0);\n      setProducts([]);\n\n      if(!!obj) {\n        obj.forEach( e => {\n          if(!!e.key)\n            props.firebase.products().child(e.key).once('value', (snapshot) => {\n              if(snapshot.exists()) {     \n                      \n                  // Try to get url from the storage\n                  storageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then( (url) => { \n\n                    let element = {...snapshot.val(), imageRef:url, key:snapshot.key}\n                    \n                    console.log(element.imageRef);\n                    if(element.isPublic) {\n                      setTotal(t => (+t + +element.price));\n                      setProducts(a => [...a, element])\n                    }                \n                    // if it fails set the url to the default image\n                  }).catch(err => {\n\n                    let element = {...snapshot.val(), imageRef:NullImage1, key:snapshot.key}\n                    if(element.isPublic) {\n                      setTotal(t => t + element.price);\n                      setProducts(a => [...a, element])\n                    }\n                  })\n              }\n            });\n          })\n      }\n    }\n  }, [props.open])\n\n  return(\n    <React.Fragment>\n      <Drawer anchor=\"right\" open={props.open} onClose={() => console.log(\"cart closed\")}>\n        <Paper className={classes.paper}>\n          <List>\n          {products.map((product, i) => (\n            <ListItem className={classes.grid}>\n              <Grid  container spacing={0}>\n                <Grid item xs ={3}>\n                  <img src={product.imageRef} width={'100%'} height={'100%'}/>\n                </Grid>\n                <Grid item xs={9}>\n                  <Typography > {product.name} </Typography>\n                  <Typography  > {product.model} </Typography>\n                  <Typography > {product.price} грн </Typography>\n                </Grid>\n              </Grid>\n            </ListItem>\n          ))}\n          </List>\n            <ListItem>\n                <Typography variant=\"h6\">Всього: {total} грн</Typography>\n            </ListItem> \n\n          <Link to=\"/checkout\" className={classes.link}> \n          <Button className={classes.cartButton}>Оплатити</Button>\n          </Link>\n        </Paper>\n\n      </Drawer>\n    </React.Fragment>\n  );\n}\n\n\nconst CartItem = (props) =>{\n\n}\n\nexport default compose(withFirebase)(CartDrawer);\n"]},"metadata":{},"sourceType":"module"}