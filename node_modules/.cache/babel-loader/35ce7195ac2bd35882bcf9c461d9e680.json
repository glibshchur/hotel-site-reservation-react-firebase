{"ast":null,"code":"import _defineProperty from \"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/hshchu/Desktop/github/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/hshchu/Desktop/github/e-commerce/src/components/Cart/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { compose } from 'recompose';\nimport { withFirebase } from '../Firebase';\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport NullImage from '../Product/No-Image-Available.jpg';\nimport Drawer from '@material-ui/core/Drawer';\nimport ListItem from '@material-ui/core/ListItem';\nimport List from '@material-ui/core/List';\nimport Paper from '@material-ui/core/Paper';\nimport { Grid, Typography, CardMedia, Card, CardContent, CardActions, Button } from '@material-ui/core';\nconst useStyles = makeStyles({\n  link: {\n    textDecoration: \"none\"\n  },\n  grid: {\n    margin: 0,\n    padding: 0,\n    marginLeft: 0\n  },\n  paper: {\n    width: 400\n  },\n  fullList: {\n    width: 'auto'\n  },\n  cartButton: {\n    height: 47,\n    width: '100%',\n    color: '#FFFFFF',\n    float: 'center',\n    backgroundColor: '#00B4F4',\n    borderRadius: 0,\n    '&:hover': {\n      backgroundColor: '#D6D6D6'\n    }\n  }\n});\n\nconst CartDrawer = props => {\n  const classes = useStyles();\n  const storageRef = props.firebase.storage;\n\n  const _React$useState = React.useState(0),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        total = _React$useState2[0],\n        setTotal = _React$useState2[1];\n\n  const _React$useState3 = React.useState([]),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        products = _React$useState4[0],\n        setProducts = _React$useState4[1];\n\n  useEffect(() => {\n    if (props.open && !!localStorage.getItem('cart')) {\n      let obj = JSON.parse(localStorage.getItem('cart'));\n      setTotal(0);\n      setProducts([]);\n\n      if (!!obj) {\n        obj.forEach(e => {\n          if (!!e.key) props.firebase.products().child(e.key).once('value', snapshot => {\n            if (snapshot.exists()) {\n              // Try to get url from the storage\n              storageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then(url => {\n                let element = _objectSpread({}, snapshot.val(), {\n                  imageRef: url,\n                  key: snapshot.key\n                });\n\n                console.log(element.imageRef);\n\n                if (element.isPublic) {\n                  setTotal(t => +t + +element.price);\n                  setProducts(a => [...a, element]);\n                } // if it fails set the url to the default image\n\n              }).catch(err => {\n                let element = _objectSpread({}, snapshot.val(), {\n                  imageRef: NullImage,\n                  key: snapshot.key\n                });\n\n                if (element.isPublic) {\n                  setTotal(t => t + element.price);\n                  setProducts(a => [...a, element]);\n                }\n              });\n            }\n          });\n        });\n      }\n    }\n  }, [props.open]);\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, React.createElement(Drawer, {\n    anchor: \"right\",\n    open: props.open,\n    onClose: () => console.log(\"cart closed\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(Paper, {\n    className: classes.paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(List, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, products.map((product, i) => React.createElement(ListItem, {\n    className: classes.grid,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    container: true,\n    spacing: 0,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 3,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: product.imageRef,\n    width: '100%',\n    height: '100%',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  })), React.createElement(Grid, {\n    item: true,\n    xs: 9,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, \" \", product.name, \" \"), React.createElement(Typography, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, \" \", product.model, \" \"), React.createElement(Typography, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, \" \", product.price, \" \\u0433\\u0440\\u043D \")))))), React.createElement(ListItem, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    variant: \"h6\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, \"\\u0412\\u0441\\u044C\\u043E\\u0433\\u043E: \", total, \" \\u0433\\u0440\\u043D\")), React.createElement(Link, {\n    to: \"/checkout\",\n    className: classes.link,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(Button, {\n    className: classes.cartButton,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, \"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u0438\")))));\n};\n\nconst CartItem = props => {};\n\nexport default compose(withFirebase)(CartDrawer);","map":{"version":3,"sources":["/Users/hshchu/Desktop/github/e-commerce/src/components/Cart/index.js"],"names":["React","useEffect","useState","useRef","makeStyles","compose","withFirebase","BrowserRouter","Router","Link","Route","NullImage","Drawer","ListItem","List","Paper","Grid","Typography","CardMedia","Card","CardContent","CardActions","Button","useStyles","link","textDecoration","grid","margin","padding","marginLeft","paper","width","fullList","cartButton","height","color","float","backgroundColor","borderRadius","CartDrawer","props","classes","storageRef","firebase","storage","total","setTotal","products","setProducts","open","localStorage","getItem","obj","JSON","parse","forEach","e","key","child","once","snapshot","exists","ref","val","previewImage","getDownloadURL","then","url","element","imageRef","console","log","isPublic","t","price","a","catch","err","map","product","i","name","model","CartItem"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { compose } from 'recompose'\nimport { withFirebase } from '../Firebase'\nimport { BrowserRouter as Router, Link, Route } from 'react-router-dom';\nimport NullImage from '../Product/No-Image-Available.jpg';\nimport Drawer from '@material-ui/core/Drawer';\nimport ListItem from '@material-ui/core/ListItem';\nimport List from '@material-ui/core/List';\nimport Paper from '@material-ui/core/Paper';\nimport { Grid, Typography, CardMedia, Card, CardContent, CardActions, Button } from '@material-ui/core'\n\nconst useStyles = makeStyles({\n  link:{\n    textDecoration:\"none\"\n  },\n  grid:{\n    margin:0,\n    padding:0,\n    marginLeft:0,\n  },\n  paper: {\n    width: 400,\n  },\n  fullList: {\n    width: 'auto',\n  },\n  cartButton:{\n    height:47,\n    width:'100%',\n    color: '#FFFFFF',\n    float:'center',\n    backgroundColor: '#00B4F4',\n    borderRadius:0,\n    '&:hover':{\n      backgroundColor: '#D6D6D6'\n    }\n  },\n  \n});\n\n\nconst CartDrawer = (props) => {\n  const classes = useStyles();\n  const storageRef = props.firebase.storage;\n\n  const [total, setTotal] = React.useState(0);\n  const [products, setProducts] = React.useState([]);\n\n  useEffect(() => {\n    if(props.open && !!localStorage.getItem('cart')){\n\n      let obj = JSON.parse(localStorage.getItem('cart'));\n      setTotal(0);\n      setProducts([]);\n\n      if(!!obj) {\n        obj.forEach( e => {\n          if(!!e.key)\n            props.firebase.products().child(e.key).once('value', (snapshot) => {\n              if(snapshot.exists()) {     \n                      \n                  // Try to get url from the storage\n                  storageRef.ref().child(snapshot.val().previewImage).getDownloadURL().then( (url) => { \n\n                    let element = {...snapshot.val(), imageRef:url, key:snapshot.key}\n                    \n                    console.log(element.imageRef);\n                    if(element.isPublic) {\n                      setTotal(t => (+t + +element.price));\n                      setProducts(a => [...a, element])\n                    }                \n                    // if it fails set the url to the default image\n                  }).catch(err => {\n\n                    let element = {...snapshot.val(), imageRef:NullImage, key:snapshot.key}\n                    if(element.isPublic) {\n                      setTotal(t => t + element.price);\n                      setProducts(a => [...a, element])\n                    }\n                  })\n              }\n            });\n          })\n      }\n    }\n  }, [props.open])\n\n  return(\n    <React.Fragment>\n      <Drawer anchor=\"right\" open={props.open} onClose={() => console.log(\"cart closed\")}>\n        <Paper className={classes.paper}>\n          <List>\n          {products.map((product, i) => (\n            <ListItem className={classes.grid}>\n              <Grid  container spacing={0}>\n                <Grid item xs ={3}>\n                  <img src={product.imageRef} width={'100%'} height={'100%'}/>\n                </Grid>\n                <Grid item xs={9}>\n                  <Typography > {product.name} </Typography>\n                  <Typography  > {product.model} </Typography>\n                  <Typography > {product.price} грн </Typography>\n                </Grid>\n              </Grid>\n            </ListItem>\n          ))}\n          </List>\n            <ListItem>\n                <Typography variant=\"h6\">Всього: {total} грн</Typography>\n            </ListItem> \n\n          <Link to=\"/checkout\" className={classes.link}> \n          <Button className={classes.cartButton}>Оплатити</Button>\n          </Link>\n        </Paper>\n\n      </Drawer>\n    </React.Fragment>\n  );\n}\n\n\nconst CartItem = (props) =>{\n\n}\n\nexport default compose(withFirebase)(CartDrawer);\n"]},"metadata":{},"sourceType":"module"}